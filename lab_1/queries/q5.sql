--replace this with your query
SELECT
	CMTE_NM,
	CANDIDATE.CAND_OFFICE_ST,
	CAND_SUMMARY.TTL_RECEIPTS,
	CAND_SUMMARY.TTL_RECEIPTS/total_population as PER_CAPITA_RECEIPTS

FROM
	CANDIDATE,
	CAND_SUMMARY,
	COMMITTEE,
	(SELECT
		state,
		sum(population) AS total_population
	FROM
		DIST_POP
	GROUP BY
		state
	) AS state_pop
	
WHERE
	CANDIDATE.CAND_ID = CAND_SUMMARY.CAND_ID
	AND CANDIDATE.CAND_PCC = COMMITTEE.CMTE_ID
	AND state_pop.state = CANDIDATE.CAND_OFFICE_ST
	AND CAND_OFFICE = 'S'
	AND CAND_STATUS IN ('C','N')
	AND CAND_ELECTION_YR = 2016

ORDER BY 
	PER_CAPITA_RECEIPTS DESC

LIMIT
	20;











